# Folio Backend Setup Instructions

## What's Been Created

✅ **20 Atomic Notes** - All written and ready in `backend/notes/`
✅ **Backend Services** - OpenAI and Pinecone services created
✅ **Embedding Script** - Script ready to embed notes into Pinecone
✅ **Requirements Updated** - Added openai and pinecone-client dependencies

## What You Need to Do

### Step 1: Get OpenAI API Key

You only need one API key:

**OpenAI API Key:**
1. Go to https://platform.openai.com/api-keys
2. Create a new API key
3. Copy it (you won't be able to see it again)

**Note:** We use local storage (JSON file) instead of Pinecone. For datasets under 1000 notes, local storage is faster, simpler, and free. No Pinecone account needed!

### Step 2: Create .env File

Create a `.env` file in the `backend/` directory:

```bash
cd backend
touch .env
```

Add your OpenAI API key to `.env`:

```env
OPENAI_API_KEY=sk-proj-...your-key-here
```

**Important:** Never commit this `.env` file to git! It's already in `.gitignore`.

### Step 3: Install Dependencies

```bash
cd backend
pip install -r requirements.txt
```

### Step 4: Embed the Notes

Run the embedding script:

```bash
python scripts/embed_notes.py
```

This will:
- Read all 20 markdown notes
- Generate embeddings using OpenAI (cost: ~$0.02 for 20 notes)
- Store embeddings locally in `backend/embeddings.json` (~30KB)
- Show progress and confirmation

Expected output:
```
Initializing services...
Reading notes from /path/to/backend/notes...
Found 20 note files
  Read: skills/python-backend-experience
  Read: skills/react-frontend-experience
  ...
Generating embeddings for 20 notes...
  [1/20] Embedding: python-backend-experience
  ...
Storing 20 embeddings locally...
Storage stats: {'total_notes': 20, 'storage_path': 'backend/embeddings.json'}
✅ Successfully embedded 20 notes into local storage!
```

### Step 5: Run Test Queries

After embedding, test the retrieval system:

```bash
python scripts/test_retrieval.py
```

This will run test queries and show:
- Which notes were retrieved for each query
- Relevance scores
- Whether retrieval behavior matches expectations

## Cost Estimates

**OpenAI:**
- Embeddings: ~$0.001 per 20 notes
- Chat completions for testing: ~$0.01 per 100 queries
- Total for full test cycle: < $0.10

**Local Storage:**
- Embeddings stored in `backend/embeddings.json`
- ~30KB for 20 notes, ~1.2MB for 200 notes
- No cost, no external service needed

## Troubleshooting

**"OPENAI_API_KEY environment variable is not set"**
- Make sure `.env` file exists in `backend/` directory
- Check that API key is correctly formatted (starts with `sk-proj-` or `sk-`)
- Try loading manually: `export OPENAI_API_KEY=your-key`

**"Embeddings file not found"**
- The script creates `backend/embeddings.json` automatically
- Make sure you have write permissions in the `backend/` directory

**Rate limiting errors**
- OpenAI free tier has rate limits
- The script processes notes one at a time to avoid hitting limits
- If you hit limits, wait a few minutes and try again

**Performance:**
- Local storage is actually faster than Pinecone for small datasets
- Query time: <20ms for 200 notes (vs 100-400ms for Pinecone network calls)
- Scales well up to ~1000 notes, then consider Pinecone if needed

## Next Steps After Embedding

1. Run test queries (`scripts/test_retrieval.py`)
2. Review which notes get retrieved for different questions
3. Evaluate answer quality and relevance
4. Iterate on note content or retrieval strategy as needed
5. Add more notes based on what works well

## Files Created

```
backend/
├── app/
│   └── services/
│       ├── openai_service.py       # OpenAI API integration
│       └── embedding_storage.py   # Local embedding storage (JSON)
├── scripts/
│   ├── embed_notes.py              # Embed notes into local storage
│   └── test_retrieval.py           # Test retrieval behavior
├── embeddings.json                 # Generated by embed_notes.py
├── notes/
│   ├── skills/                     # 3 notes
│   ├── work/                       # 2 notes
│   ├── values/                     # 2 notes
│   ├── background/                 # 2 notes
│   ├── resources/                  # 1 note
│   ├── projects/                   # 10 notes
│   └── README.md                   # Notes documentation
├── requirements.txt                # Updated with openai, pinecone
└── SETUP-INSTRUCTIONS.md          # This file
```

